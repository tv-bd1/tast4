<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Ultimate IPTV Ultra PRO</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
:root{
--bg:#000;
--card:#121212;
--accent:#00E5FF;
--fav:#FFD700;
--text:#fff;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,Arial}
body{background:var(--bg);color:#fff;height:100vh;display:flex;flex-direction:column;overflow:hidden}

/* PLAYER */
.player{position:relative;background:#000;aspect-ratio:16/9;overflow:hidden}
video{width:100%;height:100%;object-fit:contain}

/* LOADER */
.loader{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.7);z-index:10}
.loader div{width:40px;height:40px;border:4px solid #333;border-top:4px solid var(--accent);border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{100%{transform:rotate(360deg)}}

/* OSD */
.osd{
position:absolute;
bottom:25px;
left:20px;
display:flex;
gap:15px;
align-items:center;
background:rgba(0,0,0,.55);
backdrop-filter:blur(15px);
padding:12px 18px;
border-radius:18px;
transform:translateY(40px);
opacity:0;
transition:.4s;
z-index:20;
}
.osd.show{transform:translateY(0);opacity:1}
.osd img{width:50px;height:50px;border-radius:10px}
.osd-name{font-weight:600}
.live{font-size:.75rem;color:var(--accent)}

/* HUD */
.hud{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
background:rgba(0,0,0,.6);
padding:20px;
border-radius:15px;
display:none;
z-index:30;
text-align:center;
}

/* CONTROLS */
.controls{
position:absolute;
inset:0;
display:flex;
align-items:flex-end;
background:rgba(0,0,0,.5);
opacity:0;
transition:.3s;
}
.controls.show{opacity:1}
.controls-bar{
width:100%;
padding:15px;
display:flex;
justify-content:space-between;
}
.controls i{font-size:1.5rem;cursor:pointer}

/* INFO */
.info{display:flex;justify-content:space-between;align-items:center;padding:12px 15px;background:#0a0a0a}
.info img{width:45px;height:45px;border-radius:8px}

/* TABS */
.tabs{display:flex;background:#000;border-bottom:1px solid #1a1a1a}
.tabs div{flex:1;text-align:center;padding:10px;cursor:pointer;color:#888}
.tabs .active{color:var(--accent);border-bottom:2px solid var(--accent)}

/* FILTER */
.filter{padding:10px;background:#000}
.filter input,.filter select{
width:100%;
padding:10px;
margin-bottom:8px;
background:#111;
border:1px solid #222;
border-radius:10px;
color:#fff;
}

/* LIST */
.list{flex:1;overflow-y:auto;padding:10px}
.row{
display:flex;
gap:12px;
align-items:center;
background:#111;
padding:12px;
border-radius:14px;
margin-bottom:10px;
cursor:pointer;
border:1px solid #1a1a1a;
transition:.2s;
}
.row:hover{background:#181818}
.row.active{border-color:var(--accent);box-shadow:0 0 10px rgba(0,229,255,.3)}
.row img{width:50px;height:50px;border-radius:6px}
.row .name{flex:1}
.star{color:#333}
.star.fav{color:var(--fav)}
.num{color:var(--accent);font-weight:bold;width:35px}
</style>
</head>

<body>

<div class="player" id="player">
<video id="video" playsinline></video>

<div class="loader" id="loader"><div></div></div>

<div class="osd" id="osd">
<img id="osdLogo">
<div>
<div class="osd-name" id="osdName"></div>
<div class="live">‚óè LIVE</div>
</div>
</div>

<div class="hud" id="hud"></div>

<div class="controls" id="controls">
<div class="controls-bar">
<i class="fas fa-play" id="pp"></i>
<i class="fas fa-expand" id="fs"></i>
</div>
</div>
</div>

<div class="info">
<div style="display:flex;gap:10px;align-items:center">
<img id="infoLogo">
<div id="infoName">Select Channel</div>
</div>
<div id="count">0 CH</div>
</div>

<div class="tabs">
<div class="active" id="tabAll">All</div>
<div id="tabFav">My List</div>
<div onclick="window.open('https://t.me/bestiptvlive')">Telegram</div>
</div>

<div class="filter">
<select id="category"></select>
<input type="text" id="search" placeholder="Search Channel...">
</div>

<div class="list" id="list"></div>

<script>
const video=document.getElementById('video');
const list=document.getElementById('list');
const loader=document.getElementById('loader');
const osd=document.getElementById('osd');
const hud=document.getElementById('hud');
let hls=new Hls();
let channels=[];
let currentIndex=0;
let favMode=false;

/* LOAD PLAYLIST */
const playlistUrl=new URLSearchParams(location.search).get('playlist');
if(playlistUrl){
fetch(playlistUrl).then(r=>r.text()).then(data=>{
let lines=data.split('\n'),c={};
lines.forEach(l=>{
if(l.startsWith('#EXTINF')){
c.name=l.split(',')[1]?.trim();
c.logo=l.match(/tvg-logo="([^"]*)"/)?.[1];
c.group=l.match(/group-title="([^"]*)"/)?.[1]||"Other";
}
else if(l.startsWith('http')){
c.url=l.trim();
channels.push({...c});
c={};
}
});
init();
});
}

function init(){
generateCategories();
render();
if(channels[0])play(0);
}

/* PLAY */
function play(index){
currentIndex=index;
let ch=channels[index];
loader.style.display='flex';

if(ch.url.includes('.m3u8')){
hls.destroy();hls=new Hls();
hls.loadSource(ch.url);
hls.attachMedia(video);
hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
}else{
hls.destroy();
video.src=ch.url;
video.play();
}

document.getElementById('infoName').innerText=ch.name;
document.getElementById('infoLogo').src=ch.logo;
showOSD(ch);
render();
}

/* OSD */
let osdTimer;
function showOSD(ch){
document.getElementById('osdName').innerText=ch.name;
document.getElementById('osdLogo').src=ch.logo;
osd.classList.add('show');
clearTimeout(osdTimer);
osdTimer=setTimeout(()=>osd.classList.remove('show'),3500);
}

/* RENDER */
function render(){
let data=favMode?getFavs():channels;
let search=document.getElementById('search').value?.toLowerCase()||"";
let cat=document.getElementById('category').value;

data=data.filter((c,i)=>{
return c.name.toLowerCase().includes(search) &&
(cat==="All"||c.group===cat);
});

list.innerHTML="";
document.getElementById('count').innerText=data.length+" CH";

data.forEach((c,i)=>{
let realIndex=channels.findIndex(x=>x.url===c.url);
let row=document.createElement('div');
row.className="row"+(realIndex===currentIndex?" active":"");
row.innerHTML=`
<div class="num">${String(realIndex+1).padStart(2,'0')}</div>
<img src="${c.logo}">
<div class="name">${c.name}</div>
<i class="fas fa-star star ${isFav(c.url)?'fav':''}"></i>
`;
row.onclick=()=>play(realIndex);
row.querySelector('.star').onclick=(e)=>{e.stopPropagation();toggleFav(c)};
list.appendChild(row);
});
}

/* FAVORITES */
function getFavs(){return channels.filter(c=>isFav(c.url))}
function isFav(url){
return JSON.parse(localStorage.getItem('favs')||"[]").includes(url)
}
function toggleFav(c){
let favs=JSON.parse(localStorage.getItem('favs')||"[]");
if(favs.includes(c.url))favs=favs.filter(f=>f!==c.url);
else favs.push(c.url);
localStorage.setItem('favs',JSON.stringify(favs));
render();
}

/* CATEGORY */
function generateCategories(){
let cats=["All",...new Set(channels.map(c=>c.group))];
let select=document.getElementById('category');
cats.forEach(c=>{
let o=document.createElement('option');
o.textContent=c;
select.appendChild(o);
});
}

/* TABS */
document.getElementById('tabAll').onclick=function(){
favMode=false;
this.classList.add('active');
document.getElementById('tabFav').classList.remove('active');
render();
}
document.getElementById('tabFav').onclick=function(){
favMode=true;
this.classList.add('active');
document.getElementById('tabAll').classList.remove('active');
render();
}

/* SEARCH */
document.getElementById('search').oninput=render;
document.getElementById('category').onchange=render;

/* SWIPE CHANNEL CHANGE */
let startY;
document.getElementById('player').addEventListener('touchstart',e=>{
startY=e.touches[0].clientY;
});
document.getElementById('player').addEventListener('touchend',e=>{
let endY=e.changedTouches[0].clientY;
if(startY-endY>50) nextChannel();
if(endY-startY>50) prevChannel();
});
function nextChannel(){
if(currentIndex<channels.length-1)play(currentIndex+1);
}
function prevChannel(){
if(currentIndex>0)play(currentIndex-1);
}

/* CONTROLS */
document.getElementById('player').onclick=()=>{
document.getElementById('controls').classList.toggle('show');
}
document.getElementById('pp').onclick=(e)=>{
e.stopPropagation();
if(video.paused){video.play();e.target.className="fas fa-pause";}
else{video.pause();e.target.className="fas fa-play";}
}
document.getElementById('fs').onclick=(e)=>{
e.stopPropagation();
if(!document.fullscreenElement)document.getElementById('player').requestFullscreen();
else document.exitFullscreen();
}

video.onplaying=()=>loader.style.display='none';
</script>

</body>
</html>
